{% include './staffHeader.html' %}
<style>
  body {
    background-color: #f8f9fa;
  }

  .table-container {
    background: #fff;
    border-radius: 15px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.1);
    padding: 25px;
    margin-top: 40px;
  }

  .modal-header {
    background: #0d6efd;
    color: #fff;
  }

  .btn-add {
    border-radius: 30px;
    padding: 8px 20px;
  }
</style>

<body>
  <div class="container mt-5">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h2 class="fw-bold text-primary">üè® Room Management</h2>
      <button class="btn btn-primary btn-add" data-bs-toggle="modal" data-bs-target="#addRoomModal">
        <i class="bi bi-plus-circle"></i> Add Room
      </button>
    </div>

    <!-- üîç Filter Bar -->
     <form action="/filterRooms/" method="post">
         {% csrf_token %}
    <div class="filter-bar mb-3 d-flex flex-wrap gap-2">
      <select id="filterRoomType" name="roomType" class="form-select w-auto">
        <option value="">All Types</option>
        <option value="Standard">Standard</option>
        <option value="Deluxe">Deluxe</option>
        <option value="Suite">Suite</option>
        <option value="Premium">Premium</option>
      </select>

      <select id="filterStatus" name="status" class="form-select w-auto">
        <option value="">All Status</option>
        <option value="Free">Free</option>
        <option value="Booked">Booked</option>
        <option value="Served">Served</option>
      </select>

      <input type="number" name="accomodation" id="filterAccomodation" class="form-control w-auto" placeholder="Min accommodation">
      
      <button class="btn btn-outline-primary" id="applyFilter">Filter</button>
      <button class="btn btn-outline-secondary" id="resetFilter">Reset</button>
    </div>
    </form>
    <!-- Room Table -->
    <div class="table-container">
      <table class="table table-striped table-hover align-middle">
        <thead class="table-primary">
          <tr>
            <th scope="col">#</th>
            <th scope="col">Building</th>
            <th scope="col">Room Code</th>
            <th scope="col">Room Type</th>
            <th scope="col">Accomodation</th>
            <th scope="col">Price</th>
            <th scope="col">Status</th>
            <th scope="col" class="text-center">Actions</th>
          </tr>
        </thead>
        <tbody id="roomTableBody">
             {% for room in roomList %}
         <tr>
              <th scope="row">{{room.roomID}}</th>
              <td>{{room.building}}</td>
              <td>{{room.roomCode}}</td>
              <td>{{room.type}}</td>
              <td>{{room.accomodation}}</td>
              <td>{{room.price}}</td>
              <td>{{room.status}}</td>
              <td class="text-center">
                <button class="btn btn-success btn-sm"><i class="bi bi-pencil-square"></i></button>
                <button class="btn btn-danger btn-sm"><i class="bi bi-trash"></i></button>
              </td>
            </tr>
            {%  endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <!-- Add Room Modal -->
<div class="modal fade" id="addRoomModal" tabindex="-1" aria-labelledby="addRoomLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addRoomLabel">Add New Room</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <form id="addRoomForm" action="/createRoom/" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="modal-body">
        
            <div class="mb-3">
            <label class="form-label fw-bold">Room Code</label>
            <input type="text" name="roomCode" class="form-control" placeholder="Enter Room Code" rows="3" required>
          </div>
          <div class="mb-3">
            <label class="form-label fw-bold">Building</label>
            <input type="text" name="building" class="form-control" placeholder="Enter building" rows="3" required>
          </div>
           <div class="mb-3">
            <label class="form-label fw-bold">Accomodation</label>
            <input  type="number" name="accomodation" class="form-control" placeholder="Enter Accomodation" rows="3" required>
          </div>
          <!-- Room Type Dropdown -->
          <div class="mb-3">
            <label class="form-label fw-bold">Room Type</label>
            <select id="roomTypeSelect" name="roomType" class="form-select" required>
              <option value="">-- Select Room Type --</option>
              <option value="Standard">Standard</option>
              <option value="Deluxe">Deluxe</option>
              <option value="Suite">Suite</option>
              <option value="Family">Family</option>
            </select>
          </div>

          <!-- Price -->
          <div class="mb-3">
            <label class="form-label fw-bold">Price (per night)</label>
            <input type="number" id="roomPrice" name="price" class="form-control" required>
          </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-primary">Save Room</button>
        </div>
      </form>
    </div>
  </div>
</div>
</body>
<script>
  // Room type prices
  const roomPrices = {
    "Standard": 80,
    "Deluxe": 100,
    "Suite": 150,
    "Premium":120,
  };

  const roomTypeSelect = document.getElementById("roomTypeSelect");
  const roomPriceInput = document.getElementById("roomPrice");

  // Automatically update price when room type is selected
  roomTypeSelect.addEventListener("change", function() {
    const selectedType = this.value;
    if (roomPrices[selectedType]) {
      roomPriceInput.value = roomPrices[selectedType];
    } else {
      roomPriceInput.value = "";
    }
  });

   
    // Reset Filter
    document.getElementById("resetFilter").addEventListener("click", () => {
      document.getElementById("filterRoomType").value = "";
      document.getElementById("filterStatus").value = "";
      document.getElementById("filterAccomodation").value = "";
      document.querySelectorAll("#roomTableBody tr").forEach(row => row.style.display = "");
    });
</script>
